#include "kinematics.h"

void Kinematics::get_jacobi(VectorNd q, Matrix<double, 6, N>& J) {
  J(0, 0) = -a(0)*sin(q(0)) - a(1)*sin(q(0))*cos(q(1)) - a(2)*sin(q(0))*cos(q(1) + q(2)) - d(4)*sin(q(0))*sin(q(1) + q(2) + q(3));
  J(1, 0) = a(0)*cos(q(0)) + a(1)*cos(q(0))*cos(q(1)) + a(2)*cos(q(0))*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))*cos(q(0));
  J(2, 0) = 0;
  J(3, 0) = 0;
  J(4, 0) = 0;
  J(5, 0) = 1;
  J(0, 1) = -a(1)*sin(q(1))*cos(q(0)) - a(2)*sin(q(1) + q(2))*cos(q(0)) + d(4)*cos(q(0))*cos(q(1) + q(2) + q(3));
  J(1, 1) = -a(1)*sin(q(0))*sin(q(1)) - a(2)*sin(q(0))*sin(q(1) + q(2)) + d(4)*sin(q(0))*cos(q(1) + q(2) + q(3));
  J(2, 1) = a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3));
  J(3, 1) = sin(q(0));
  J(4, 1) = -cos(q(0));
  J(5, 1) = 0;
  J(0, 2) = -a(2)*sin(q(1) + q(2))*cos(q(0)) + d(4)*cos(q(0))*cos(q(1) + q(2) + q(3));
  J(1, 2) = -a(2)*sin(q(0))*sin(q(1) + q(2)) + d(4)*sin(q(0))*cos(q(1) + q(2) + q(3));
  J(2, 2) = a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3));
  J(3, 2) = sin(q(0));
  J(4, 2) = -cos(q(0));
  J(5, 2) = 0;
  J(0, 3) = d(4)*cos(q(0))*cos(q(1) + q(2) + q(3));
  J(1, 3) = d(4)*sin(q(0))*cos(q(1) + q(2) + q(3));
  J(2, 3) = d(4)*sin(q(1) + q(2) + q(3));
  J(3, 3) = sin(q(0));
  J(4, 3) = -cos(q(0));
  J(5, 3) = 0;
  J(0, 4) = 0;
  J(1, 4) = 0;
  J(2, 4) = 0;
  J(3, 4) = sin(q(1) + q(2) + q(3))*cos(q(0));
  J(4, 4) = sin(q(0))*sin(q(1) + q(2) + q(3));
  J(5, 4) = -cos(q(1) + q(2) + q(3));
}

void Kinematics::get_pinv_jacobi_num(VectorNd q, Matrix<double, N, 6>& J) {
  Matrix<double, 6, N> J0;
  Kinematics::get_jacobi(q, J0);
  J = J0.transpose() * (J0 * J0.transpose());
}

void Kinematics::get_pinv_jacobi(VectorNd q, Matrix<double, N, 6>& J) {
  J(0, 0) = (-a(0) - a(1)*cos(q(1)) - a(2)*cos(q(1) + q(2)) - d(4)*sin(q(1) + q(2) + q(3)) + (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(cos(q(1) + q(2) + q(3)), 2) + pow(a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2) + pow(a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2) - pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2))*pow(cos(q(0)), 2) - (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(cos(q(0)), 2)*pow(cos(q(1) + q(2) + q(3)), 2) + pow(a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2)*pow(cos(q(0)), 2) + pow(a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2)*pow(cos(q(0)), 2) + pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)*pow(sin(q(0)), 2)))*sin(q(0));
  J(1, 0) = (1.0L/2.0L)*pow(a(1), 3)*sin(q(0) - q(1)) - 1.0L/2.0L*pow(a(1), 3)*sin(q(0) + q(1)) - pow(a(1), 2)*a(2)*sin(-q(0) + q(1) + q(2)) + (1.0L/2.0L)*pow(a(1), 2)*a(2)*sin(q(0) - q(1) + q(2)) - 1.0L/2.0L*pow(a(1), 2)*a(2)*sin(q(0) + q(1) - q(2)) - pow(a(1), 2)*a(2)*sin(q(0) + q(1) + q(2)) + pow(a(1), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(1), 2)*d(4)*cos(q(0) - q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(1), 2)*d(4)*cos(q(0) + q(1) - q(2) - q(3)) + pow(a(1), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) + (5.0L/4.0L)*a(1)*pow(a(2), 2)*sin(q(0) - q(1)) - 5.0L/4.0L*a(1)*pow(a(2), 2)*sin(q(0) + q(1)) - 3.0L/4.0L*a(1)*pow(a(2), 2)*sin(-q(0) + q(1) + 2*q(2)) - 3.0L/4.0L*a(1)*pow(a(2), 2)*sin(q(0) + q(1) + 2*q(2)) + (5.0L/4.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + q(3)) - 5.0L/4.0L*a(1)*a(2)*d(4)*cos(q(0) - q(1) + q(3)) - 5.0L/4.0L*a(1)*a(2)*d(4)*cos(q(0) + q(1) - q(3)) + (5.0L/4.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + q(3)) + (3.0L/2.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + 2*q(2) + q(3)) + (3.0L/2.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + 2*q(2) + q(3)) + (3.0L/2.0L)*a(1)*pow(d(4), 2)*sin(q(0) - q(1)) - 3.0L/2.0L*a(1)*pow(d(4), 2)*sin(q(0) + q(1)) + a(1)*pow(d(4), 2)*sin(-q(0) + q(1) + 2*q(2) + 2*q(3)) + a(1)*pow(d(4), 2)*sin(q(0) + q(1) + 2*q(2) + 2*q(3)) + (1.0L/2.0L)*a(1)*sin(q(0) - q(1)) - 1.0L/2.0L*a(1)*sin(q(0) + q(1)) - pow(a(2), 3)*sin(-q(0) + q(1) + q(2)) - pow(a(2), 3)*sin(q(0) + q(1) + q(2)) + 2*pow(a(2), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - pow(a(2), 2)*d(4)*cos(q(0) - q(1) - q(2) + q(3)) - pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) - q(3)) + 2*pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2) + 2*q(3)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*sin(-q(0) + q(1) + q(2)) - a(2)*sin(q(0) + q(1) + q(2)) + (3.0L/2.0L)*pow(d(4), 3)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*cos(q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(q(0) + q(1) + q(2) + q(3));
  J(2, 0) = -1.0L/4.0L*pow(a(1), 2)*a(2)*sin(-q(0) + q(1) + q(2)) + (1.0L/4.0L)*pow(a(1), 2)*a(2)*sin(q(0) - q(1) + q(2)) - 1.0L/4.0L*pow(a(1), 2)*a(2)*sin(q(0) + q(1) - q(2)) - 1.0L/4.0L*pow(a(1), 2)*a(2)*sin(q(0) + q(1) + q(2)) + (1.0L/4.0L)*pow(a(1), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*cos(q(0) - q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*cos(q(0) + q(1) - q(2) - q(3)) + (1.0L/4.0L)*pow(a(1), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) + (3.0L/4.0L)*a(1)*pow(a(2), 2)*sin(q(0) - q(1)) - 3.0L/4.0L*a(1)*pow(a(2), 2)*sin(q(0) + q(1)) - 1.0L/4.0L*a(1)*pow(a(2), 2)*sin(-q(0) + q(1) + 2*q(2)) - 1.0L/4.0L*a(1)*pow(a(2), 2)*sin(q(0) + q(1) + 2*q(2)) + (3.0L/4.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + q(3)) - 3.0L/4.0L*a(1)*a(2)*d(4)*cos(q(0) - q(1) + q(3)) - 3.0L/4.0L*a(1)*a(2)*d(4)*cos(q(0) + q(1) - q(3)) + (3.0L/4.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + q(3)) + (1.0L/2.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + 2*q(2) + q(3)) + (1.0L/2.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + 2*q(2) + q(3)) + (3.0L/4.0L)*a(1)*pow(d(4), 2)*sin(q(0) - q(1)) - 3.0L/4.0L*a(1)*pow(d(4), 2)*sin(q(0) + q(1)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*sin(-q(0) + q(1) + 2*q(2) + 2*q(3)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*sin(q(0) + q(1) + 2*q(2) + 2*q(3)) + (1.0L/2.0L)*a(1)*sin(q(0) - q(1)) - 1.0L/2.0L*a(1)*sin(q(0) + q(1)) - pow(a(2), 3)*sin(-q(0) + q(1) + q(2)) - pow(a(2), 3)*sin(q(0) + q(1) + q(2)) + 2*pow(a(2), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - pow(a(2), 2)*d(4)*cos(q(0) - q(1) - q(2) + q(3)) - pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) - q(3)) + 2*pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2) + 2*q(3)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*sin(-q(0) + q(1) + q(2)) - a(2)*sin(q(0) + q(1) + q(2)) + (3.0L/2.0L)*pow(d(4), 3)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*cos(q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(q(0) + q(1) + q(2) + q(3));
  J(3, 0) = (1.0L/4.0L)*pow(a(1), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*cos(q(0) - q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*cos(q(0) + q(1) - q(2) - q(3)) + (1.0L/4.0L)*pow(a(1), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + q(3)) - 1.0L/2.0L*a(1)*a(2)*d(4)*cos(q(0) - q(1) + q(3)) - 1.0L/2.0L*a(1)*a(2)*d(4)*cos(q(0) + q(1) - q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*cos(-q(0) + q(1) + 2*q(2) + q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*cos(q(0) + q(1) + 2*q(2) + q(3)) + (3.0L/4.0L)*a(1)*pow(d(4), 2)*sin(q(0) - q(1)) - 3.0L/4.0L*a(1)*pow(d(4), 2)*sin(q(0) + q(1)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*sin(-q(0) + q(1) + 2*q(2) + 2*q(3)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*sin(q(0) + q(1) + 2*q(2) + 2*q(3)) + (1.0L/2.0L)*a(1)*sin(q(0) - q(1)) - 1.0L/2.0L*a(1)*sin(q(0) + q(1)) + (1.0L/2.0L)*pow(a(2), 2)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(2), 2)*d(4)*cos(q(0) - q(1) - q(2) + q(3)) - 1.0L/2.0L*pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) - q(3)) + (1.0L/2.0L)*pow(a(2), 2)*d(4)*cos(q(0) + q(1) + q(2) + q(3)) - 3.0L/2.0L*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2)) - 3.0L/2.0L*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2)) + (1.0L/2.0L)*a(2)*pow(d(4), 2)*sin(-q(0) + q(1) + q(2) + 2*q(3)) + (1.0L/2.0L)*a(2)*pow(d(4), 2)*sin(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*sin(-q(0) + q(1) + q(2)) - a(2)*sin(q(0) + q(1) + q(2)) + (3.0L/2.0L)*pow(d(4), 3)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*cos(q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*cos(q(0) + q(1) + q(2) + q(3));
  J(4, 0) = (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*sin(q(0))*cos(q(1) + q(2) + q(3));
  J(0, 1) = (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)) - (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(cos(q(1) + q(2) + q(3)), 2) + pow(a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2) + pow(a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2) - pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2))*pow(sin(q(0)), 2) + (a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(sin(q(0)), 2)*pow(cos(q(1) + q(2) + q(3)), 2) + pow(a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2)*pow(sin(q(0)), 2) + pow(a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)), 2)*pow(sin(q(0)), 2) + pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)*pow(cos(q(0)), 2)))*cos(q(0));

  J(1, 1) = -1.0L/2.0L*pow(a(1), 3)*cos(q(0) - q(1)) + (1.0L/2.0L)*pow(a(1), 3)*cos(q(0) + q(1)) - pow(a(1), 2)*a(2)*cos(-q(0) + q(1) + q(2)) - 1.0L/2.0L*pow(a(1), 2)*a(2)*cos(q(0) - q(1) + q(2)) + (1.0L/2.0L)*pow(a(1), 2)*a(2)*cos(q(0) + q(1) - q(2)) + pow(a(1), 2)*a(2)*cos(q(0) + q(1) + q(2)) - pow(a(1), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(1), 2)*d(4)*sin(q(0) - q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(1), 2)*d(4)*sin(q(0) + q(1) - q(2) - q(3)) + pow(a(1), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 5.0L/4.0L*a(1)*pow(a(2), 2)*cos(q(0) - q(1)) + (5.0L/4.0L)*a(1)*pow(a(2), 2)*cos(q(0) + q(1)) - 3.0L/4.0L*a(1)*pow(a(2), 2)*cos(-q(0) + q(1) + 2*q(2)) + (3.0L/4.0L)*a(1)*pow(a(2), 2)*cos(q(0) + q(1) + 2*q(2)) - 5.0L/4.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + q(3)) - 5.0L/4.0L*a(1)*a(2)*d(4)*sin(q(0) - q(1) + q(3)) - 5.0L/4.0L*a(1)*a(2)*d(4)*sin(q(0) + q(1) - q(3)) + (5.0L/4.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + q(3)) - 3.0L/2.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + 2*q(2) + q(3)) + (3.0L/2.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + 2*q(2) + q(3)) - 3.0L/2.0L*a(1)*pow(d(4), 2)*cos(q(0) - q(1)) + (3.0L/2.0L)*a(1)*pow(d(4), 2)*cos(q(0) + q(1)) + a(1)*pow(d(4), 2)*cos(-q(0) + q(1) + 2*q(2) + 2*q(3)) - a(1)*pow(d(4), 2)*cos(q(0) + q(1) + 2*q(2) + 2*q(3)) - 1.0L/2.0L*a(1)*cos(q(0) - q(1)) + (1.0L/2.0L)*a(1)*cos(q(0) + q(1)) - pow(a(2), 3)*cos(-q(0) + q(1) + q(2)) + pow(a(2), 3)*cos(q(0) + q(1) + q(2)) - 2*pow(a(2), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - pow(a(2), 2)*d(4)*sin(q(0) - q(1) - q(2) + q(3)) - pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) - q(3)) + 2*pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2)) + (9.0L/4.0L)*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2) + 2*q(3)) - 5.0L/4.0L*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*cos(-q(0) + q(1) + q(2)) + a(2)*cos(q(0) + q(1) + q(2)) - 3.0L/2.0L*pow(d(4), 3)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*sin(q(0) + q(1) + q(2) + q(3)) - 3.0L/2.0L*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*sin(q(0) + q(1) + q(2) + q(3));
  J(2, 1) = -1.0L/4.0L*pow(a(1), 2)*a(2)*cos(-q(0) + q(1) + q(2)) - 1.0L/4.0L*pow(a(1), 2)*a(2)*cos(q(0) - q(1) + q(2)) + (1.0L/4.0L)*pow(a(1), 2)*a(2)*cos(q(0) + q(1) - q(2)) + (1.0L/4.0L)*pow(a(1), 2)*a(2)*cos(q(0) + q(1) + q(2)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*sin(q(0) - q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*sin(q(0) + q(1) - q(2) - q(3)) + (1.0L/4.0L)*pow(a(1), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 3.0L/4.0L*a(1)*pow(a(2), 2)*cos(q(0) - q(1)) + (3.0L/4.0L)*a(1)*pow(a(2), 2)*cos(q(0) + q(1)) - 1.0L/4.0L*a(1)*pow(a(2), 2)*cos(-q(0) + q(1) + 2*q(2)) + (1.0L/4.0L)*a(1)*pow(a(2), 2)*cos(q(0) + q(1) + 2*q(2)) - 3.0L/4.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + q(3)) - 3.0L/4.0L*a(1)*a(2)*d(4)*sin(q(0) - q(1) + q(3)) - 3.0L/4.0L*a(1)*a(2)*d(4)*sin(q(0) + q(1) - q(3)) + (3.0L/4.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + q(3)) - 1.0L/2.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + 2*q(2) + q(3)) + (1.0L/2.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + 2*q(2) + q(3)) - 3.0L/4.0L*a(1)*pow(d(4), 2)*cos(q(0) - q(1)) + (3.0L/4.0L)*a(1)*pow(d(4), 2)*cos(q(0) + q(1)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*cos(-q(0) + q(1) + 2*q(2) + 2*q(3)) - 1.0L/4.0L*a(1)*pow(d(4), 2)*cos(q(0) + q(1) + 2*q(2) + 2*q(3)) - 1.0L/2.0L*a(1)*cos(q(0) - q(1)) + (1.0L/2.0L)*a(1)*cos(q(0) + q(1)) - pow(a(2), 3)*cos(-q(0) + q(1) + q(2)) + pow(a(2), 3)*cos(q(0) + q(1) + q(2)) - 2*pow(a(2), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - pow(a(2), 2)*d(4)*sin(q(0) - q(1) - q(2) + q(3)) - pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) - q(3)) + 2*pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 9.0L/4.0L*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2)) + (9.0L/4.0L)*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2)) + (5.0L/4.0L)*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2) + 2*q(3)) - 5.0L/4.0L*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*cos(-q(0) + q(1) + q(2)) + a(2)*cos(q(0) + q(1) + q(2)) - 3.0L/2.0L*pow(d(4), 3)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*sin(q(0) + q(1) + q(2) + q(3)) - 3.0L/2.0L*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*sin(q(0) + q(1) + q(2) + q(3));
  J(3, 1) = -1.0L/4.0L*pow(a(1), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*sin(q(0) - q(1) + q(2) + q(3)) - 1.0L/4.0L*pow(a(1), 2)*d(4)*sin(q(0) + q(1) - q(2) - q(3)) + (1.0L/4.0L)*pow(a(1), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 1.0L/4.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + q(3)) - 1.0L/2.0L*a(1)*a(2)*d(4)*sin(q(0) - q(1) + q(3)) - 1.0L/2.0L*a(1)*a(2)*d(4)*sin(q(0) + q(1) - q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + q(3)) - 1.0L/4.0L*a(1)*a(2)*d(4)*sin(-q(0) + q(1) + 2*q(2) + q(3)) + (1.0L/4.0L)*a(1)*a(2)*d(4)*sin(q(0) + q(1) + 2*q(2) + q(3)) - 3.0L/4.0L*a(1)*pow(d(4), 2)*cos(q(0) - q(1)) + (3.0L/4.0L)*a(1)*pow(d(4), 2)*cos(q(0) + q(1)) + (1.0L/4.0L)*a(1)*pow(d(4), 2)*cos(-q(0) + q(1) + 2*q(2) + 2*q(3)) - 1.0L/4.0L*a(1)*pow(d(4), 2)*cos(q(0) + q(1) + 2*q(2) + 2*q(3)) - 1.0L/2.0L*a(1)*cos(q(0) - q(1)) + (1.0L/2.0L)*a(1)*cos(q(0) + q(1)) - 1.0L/2.0L*pow(a(2), 2)*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) - 1.0L/2.0L*pow(a(2), 2)*d(4)*sin(q(0) - q(1) - q(2) + q(3)) - 1.0L/2.0L*pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) - q(3)) + (1.0L/2.0L)*pow(a(2), 2)*d(4)*sin(q(0) + q(1) + q(2) + q(3)) - 3.0L/2.0L*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2)) + (3.0L/2.0L)*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2)) + (1.0L/2.0L)*a(2)*pow(d(4), 2)*cos(-q(0) + q(1) + q(2) + 2*q(3)) - 1.0L/2.0L*a(2)*pow(d(4), 2)*cos(q(0) + q(1) + q(2) + 2*q(3)) - a(2)*cos(-q(0) + q(1) + q(2)) + a(2)*cos(q(0) + q(1) + q(2)) - 3.0L/2.0L*pow(d(4), 3)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*pow(d(4), 3)*sin(q(0) + q(1) + q(2) + q(3)) - 3.0L/2.0L*d(4)*sin(-q(0) + q(1) + q(2) + q(3)) + (3.0L/2.0L)*d(4)*sin(q(0) + q(1) + q(2) + q(3));
  J(4, 1) = -(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*cos(q(0))*cos(q(1) + q(2) + q(3));
  J(0, 2) = 0;
  J(1, 2) = (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(sin(q(0)), 2) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(cos(q(0)), 2) + (a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(sin(q(1) + q(2) + q(3)), 2) + pow(a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2) + pow(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(sin(q(0)), 2) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(cos(q(0)), 2);
  J(2, 2) = (a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(sin(q(0)), 2) + (a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(cos(q(0)), 2) + (a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)))*(pow(d(4), 2)*pow(sin(q(1) + q(2) + q(3)), 2) + pow(a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2) + pow(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(sin(q(0)), 2) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(cos(q(0)), 2);
  J(3, 2) = d(4)*(pow(d(4), 2)*pow(sin(q(1) + q(2) + q(3)), 2) + pow(a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2) + pow(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2))*sin(q(1) + q(2) + q(3)) - d(4)*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(sin(q(0)), 2)*cos(q(1) + q(2) + q(3)) - d(4)*((1.0L/2.0L)*pow(a(2), 2)*sin(2*q(1) + 2*q(2)) - a(2)*d(4)*cos(2*q(1) + 2*q(2) + q(3)) - pow(d(4), 2)*sin(2*q(1) + 2*q(2) + 2*q(3)) + (a(1)*sin(q(1)) + a(2)*sin(q(1) + q(2)) - d(4)*cos(q(1) + q(2) + q(3)))*(a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3))))*pow(cos(q(0)), 2)*cos(q(1) + q(2) + q(3)) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(sin(q(0)), 2) + (a(1)*cos(q(1)) + 2*a(2)*cos(q(1) + q(2)) + 3*d(4)*sin(q(1) + q(2) + q(3)))*pow(cos(q(0)), 2);
  J(4, 2) = 0;
  J(0, 3) = -1.0L/4.0L*sin(-q(0) + 2*q(1) + 2*q(2) + 2*q(3)) - 1.0L/4.0L*sin(q(0) + 2*q(1) + 2*q(2) + 2*q(3));
  J(1, 3) = (pow(a(1), 2) + 3*a(1)*a(2)*cos(q(2)) + 4*a(1)*d(4)*sin(q(2) + q(3)) + 2*pow(a(2), 2) + 5*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*sin(q(0));
  J(2, 3) = (a(1)*a(2)*cos(q(2)) + a(1)*d(4)*sin(q(2) + q(3)) + 2*pow(a(2), 2) + 5*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*sin(q(0));
  J(3, 3) = (a(1)*d(4)*sin(q(2) + q(3)) + 2*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*sin(q(0));
  J(4, 3) = sin(q(1) + q(2) + q(3))*cos(q(0));
  J(0, 4) = -1.0L/4.0L*cos(-q(0) + 2*q(1) + 2*q(2) + 2*q(3)) + (1.0L/4.0L)*cos(q(0) + 2*q(1) + 2*q(2) + 2*q(3));
  J(1, 4) = -(pow(a(1), 2) + 3*a(1)*a(2)*cos(q(2)) + 4*a(1)*d(4)*sin(q(2) + q(3)) + 2*pow(a(2), 2) + 5*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*cos(q(0));
  J(2, 4) = -(a(1)*a(2)*cos(q(2)) + a(1)*d(4)*sin(q(2) + q(3)) + 2*pow(a(2), 2) + 5*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*cos(q(0));
  J(3, 4) = -(a(1)*d(4)*sin(q(2) + q(3)) + 2*a(2)*d(4)*sin(q(3)) + 3*pow(d(4), 2) + 3)*cos(q(0));
  J(4, 4) = sin(q(0))*sin(q(1) + q(2) + q(3));

  J(0, 5) = pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)*pow(sin(q(0)), 2) + pow(a(0) + a(1)*cos(q(1)) + a(2)*cos(q(1) + q(2)) + d(4)*sin(q(1) + q(2) + q(3)), 2)*pow(cos(q(0)), 2) + pow(cos(q(1) + q(2) + q(3)), 2) + 1;
  J(1, 5) = 0;
  J(2, 5) = 0;
  J(3, 5) = 0;
  J(4, 5) = -2*cos(q(1) + q(2) + q(3));
}